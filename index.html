<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=1024">
<title>LAPORAN KAS GANG MAWAR 3</title>
<style>
:root{
 --bg:#f5f5f5;--card:#ffffff;--text:#000000;--border:#cccccc;--accent:#4caf50;--danger:#d9534f;--success:#28a745;--yellow:#fff200;--font:Arial,sans-serif;
}

/* --- LOGO STYLING (PNG TRANSPARAN) --- */
.logo-mawar-container {
    position: fixed;
    top: 10px;
    left: 15px;
    z-index: 1001;
    display: flex;
    align-items: center;
}
.logo-img {
    width: 60px;
    height: auto;
    /* Cahaya mengikuti lekuk logo transparan */
    filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
    transition: all 0.3s;
}
.logo-welcome {
    width: 200px;
    height: auto;
    margin-bottom: 20px;
    filter: drop-shadow(0 0 15px #00ffcc);
}

/* --- SAPU JAGAT FIX --- */
input:disabled {
  -webkit-text-fill-color: currentcolor !important;
  color: inherit !important;
  opacity: 1 !important;
}

/* --- UKURAN TOMBOL --- */
button {
  padding: 20px 32px; 
  font-size: 1.2rem;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  text-transform: uppercase;
  border: 0;
  transition: all 0.2s;
}

/* --- STYLE WELCOME SCREEN --- */
#welcomeScreen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: #000; color: #fff; z-index: 99999; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;
}
#welcomeScreen h1 { font-size: 2.2rem; color: #00ffcc; text-shadow: 0 0 15px #00ffcc; margin: 0 20px 10px; }
#welcomeScreen p { font-size: 0.9rem; color: #888; text-transform: none; }
#enterBtn { padding: 15px 80px; background: #00ffcc; color: #000; font-weight: bold; border-radius: 8px; border: none; cursor: pointer; text-transform: uppercase; font-size: 1.2rem; box-shadow: 0 0 20px rgba(0,255,204,0.4); }

/* --- KODE UTAMA --- */
body{font-family:var(--font);background:var(--bg);margin:0;padding:20px;text-transform:uppercase;color:var(--text);}
header{text-align:center;font-size:2rem;margin-bottom:5px}
.update-info {text-align:center; font-size:0.85rem; color:#666; margin-bottom:10px; text-transform:none;}
#deadline-banner { background: #333; color: #fff; padding: 10px; margin: 10px 16px; border-radius: 8px; font-weight: bold; overflow: hidden; white-space: nowrap; }
#deadline-banner marquee { font-size: 1.1rem; }

.menu-container {position:fixed; top:12px; right:12px; z-index:1000; display:flex; flex-direction:column; align-items:flex-end; gap:8px}
.menu-items {display:none; flex-direction:column; gap:8px; background:rgba(0,0,0,0.9); padding:12px; border-radius:12px; width: 250px;}
.menu-items.show {display:flex}
button.main-menu {background:#333; color:#fff; border:2px solid #fff;}

.block{margin:16px;padding:14px;background:var(--card);border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,.08);position:relative;}
.block h2{font-size:1.3rem;margin-bottom:10px;text-align:center}
.pulse-line { display:none; height:2px; width:100%; background:linear-gradient(90deg, transparent, #00ffcc, #ff00ff, transparent); margin-bottom:15px; }

table{width:100%;border-collapse:collapse}
th,td{border:1px solid var(--border);padding:6px;text-align:left}
th{text-align:center; background:#eee; color:#000}
input{padding:4px;border-radius:6px;border:1px solid #ccc;width:100%;box-sizing:border-box;text-transform:none;color:inherit; background:transparent;}

/* --- CYBERPUNK THEME --- */
.theme-cyberpunk{--bg:#050505;--card:#0f0f0f;--text:#00ffcc;--border:#ff00ff;--accent:#ffff00;--yellow:#ffff00;}
.theme-cyberpunk .pulse-line { display:block; }
.theme-cyberpunk .logo-img { filter: drop-shadow(0 0 10px #00ffcc); }

#checklistModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:2000; padding:20px; }
</style>
</head>
<body>

<div id="welcomeScreen">
    <img src="logo.png" alt="LOGO MAWAR 3" class="logo-welcome">
    <h1>SELAMAT DATANG DI WEBSITE KAS GANG MAWAR 3</h1>
    <p>Built and developed by Fajar Ilmanosa Viar Copyright © 2026 Gang Mawar 3 . All Rights Reserved.</p>
    <button id="enterBtn" onclick="masukWeb()">ENTER</button>
</div>

<div class="logo-mawar-container">
    <img src="logo.png" alt="LOGO" class="logo-img">
</div>

<header>
  LAPORAN KAS GANG MAWAR 3
  <div style="margin-top:10px; text-align:center">
    <button onclick="prevMonth()">◀</button>
    <span id="periode" style="min-width:180px; display:inline-block">...</span>
    <button onclick="nextMonth()">▶</button>
  </div>
  <div class="update-info" id="lastUpdate">TERAKHIR DI UPDATE PADA: -</div>
</header>

<div id="deadline-banner">
    <marquee id="deadline-text" scrollamount="5">Mengecek tanggal...</marquee>
</div>

<div class="menu-container">
    <button class="main-menu" onclick="toggleMenu()">☰ MENU</button>
    <div class="menu-items" id="menuItems">
        <button id="adminBtn" class="off">ADMIN OFF</button>
        <button onclick="openChecklist()" class="primary">CHECKLIST KAS</button>
        <button id="themeBtn" class="primary">GANTI TEMA</button>
        <button id="cetakBtn" class="primary">CETAK LAPORAN</button>
    </div>
</div>

<div class="block">
<h2>PEMASUKAN</h2>
<div class="pulse-line"></div>
<table>
<tr><th style="width:40px">Tgl</th><th style="width:25%">Nama</th><th style="width:60%">Keterangan</th><th style="width:15%">Masuk</th><th style="width:15%">Saldo</th></tr>
<tbody id="tbMasuk"></tbody>
</table>
</div>

<div class="block">
<h2>PENGELUARAN</h2>
<div class="pulse-line"></div>
<table>
<tr><th style="width:30px">Tgl</th><th style="width:40%">Keterangan</th><th style="width:8%">Qty</th><th style="width:25%">Harga</th><th style="width:25%">Total</th></tr>
<tbody id="tbKeluar"></tbody>
</table>
</div>

<div class="block">
<h2>GRAND TOTAL</h2>
<table style="width:100%; border-collapse:collapse; text-align:center;">
<tr><th>TOTAL MASUK</th><th>TOTAL KELUAR</th><th>SALDO AKHIR</th></tr>
<tr><td id="totalMasuk" style="background:#28a745; color:#fff;">0</td><td id="totalKeluar" style="background:#d9534f; color:#fff;">0</td><td id="saldoAkhir" style="background:#fff200; color:#000;">0</td></tr>
</table>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyAn5Iw4cI8bRSGuyRr3TNNVWzQA-duRHvk",
    authDomain: "kasmawar3-59c18.firebaseapp.com",
    databaseURL: "https://kasmawar3-59c18-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "kasmawar3-59c18",
    storageBucket: "kasmawar3-59c18.firebasestorage.app",
    messagingSenderId: "643313437210",
    appId: "1:643313437210:web:7377bbd6e4cd9aa33b5fa3"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const daftarKunci = {
    "D3/2": "RIZAL", "D3/3": "ROMI", "D3/4": "TRI", "D3/5": "ANIS",
    "D3/6": "FAJAR DJAKA", "D3/7": "FAJAR SHANUM", "D3/10": "AGUS", "D3/11": "LUKMAN",
    "D2/16": "IRAWAN", "D2/17": "RIAN", "D2/18": "MULYADIE", "D2/19": "HELDI",
    "D2/20": "HILMAN", "D2/21": "HILMAN", "D2/22": "NANO", "D2/23": "TEGUH"
};

let bulan = new Date().getMonth(), tahun = new Date().getFullYear(), isAdmin=false;
const namaBulan=['JANUARI','FEBRUARI','MARET','APRIL','MEI','JUNI','JULI','AGUSTUS','SEPTEMBER','OKTOBER','NOVEMBER','DESEMBER'];
const namaAnggota=['SISA KAS SEBELUMNYA','RIZAL','ROMI','TRI','ANIS','FAJAR DJAKA','FAJAR SHANUM','AGUS','LUKMAN','IRAWAN','RIAN','MULYADIE','HELDI','HILMAN','NANO','TEGUH'];

function masukWeb() {
    let kunci = prompt("MASUKKAN NOMOR BLOK:");
    if (!kunci) return;
    let bersih = kunci.toUpperCase().replace(/\s+/g, '');
    if (daftarKunci[bersih]) { 
        document.getElementById('welcomeScreen').remove();
        window.scrollTo(0,0);
    } else { alert("BLOK SALAH!"); }
}

function toggleMenu() { document.getElementById('menuItems').classList.toggle('show'); }

function buildTables(){
 document.getElementById('tbMasuk').innerHTML=''; document.getElementById('tbKeluar').innerHTML='';
 namaAnggota.forEach(n=>{
  const tr=document.createElement('tr');
  tr.innerHTML=`<td><input class='editable' type='date'></td><td><input class='editable' value='${n}'></td><td><input class='editable'></td><td><input class='editable' value='0'></td><td class='saldo'>0</td>`;
  document.getElementById('tbMasuk').appendChild(tr);
 });
 for(let i=0;i<10;i++){
  const tr=document.createElement('tr');
  tr.innerHTML=`<td><input class='editable' type='date'></td><td><input class='editable'></td><td><input class='editable' value='0'></td><td><input class='editable' value='0'></td><td class='total'>0</td>`;
  document.getElementById('tbKeluar').appendChild(tr);
 }
}

function loadData(){
 buildTables();
 db.ref('kas_data/'+bulan+'-'+tahun).once('value', s=>{
  const d=s.val();
  if(d){
   if(d.masuk) d.masuk.forEach((r,i)=>{ const tr=document.querySelectorAll('#tbMasuk tr')[i]; if(tr){ tr.children[0].firstChild.value=r.tanggal||''; tr.children[2].firstChild.value=r.ket||''; tr.children[3].firstChild.value=r.uang||'0'; } });
   if(d.keluar) d.keluar.forEach((r,i)=>{ const tr=document.querySelectorAll('#tbKeluar tr')[i]; if(tr){ tr.children[0].firstChild.value=r.tanggal||''; tr.children[1].firstChild.value=r.ket||''; tr.children[2].firstChild.value=r.qty||'0'; tr.children[3].firstChild.value=r.harga||'0'; } });
  }
  recalc();
 });
}

function recalc(){
 let tM=0, tK=0, runM=0;
 document.querySelectorAll('#tbMasuk tr').forEach(tr=>{
  let u=parseInt(tr.children[3].firstChild.value.replace(/[^0-9]/g,''))||0; runM+=u; tM+=u;
  tr.children[4].textContent=runM.toLocaleString('id-ID');
 });
 document.querySelectorAll('#tbKeluar tr').forEach(tr=>{
  let q=parseInt(tr.children[2].firstChild.value.replace(/[^0-9]/g,''))||0, h=parseInt(tr.children[3].firstChild.value.replace(/[^0-9]/g,''))||0; tK+=(q*h);
  tr.children[4].textContent=(q*h).toLocaleString('id-ID');
 });
 document.getElementById('totalMasuk').textContent=tM.toLocaleString('id-ID');
 document.getElementById('totalKeluar').textContent=tK.toLocaleString('id-ID');
 document.getElementById('saldoAkhir').textContent=(tM-tK).toLocaleString('id-ID');
 document.querySelectorAll('.editable').forEach(i=>{ i.disabled=!isAdmin; });
}

function prevMonth(){ bulan--; if(bulan<0){bulan=11; tahun--;} updateUI(); }
function nextMonth(){ bulan++; if(bulan>11){bulan=0; tahun++;} updateUI(); }
function updateUI(){ document.getElementById('periode').textContent=namaBulan[bulan]+' '+tahun; loadData(); }

document.getElementById('adminBtn').onclick = function() {
  let p=prompt('PASS');
  if(p==='SANUMION'){ isAdmin=true; this.textContent='ADMIN ON'; recalc(); }
};

document.getElementById('themeBtn').onclick=()=>{
 const body = document.body;
 if(body.classList.contains('theme-cyberpunk')) body.classList.remove('theme-cyberpunk');
 else body.classList.add('theme-cyberpunk');
};

document.addEventListener('input', recalc);
updateUI();

/* --- PROTEKSI REFRESH PILIHAN TUAN --- */
window.onbeforeunload = function() {
    return "Tuan, yakin ingin refresh? Pastikan data sudah tersimpan.";
};
</script>
</body>
</html>
